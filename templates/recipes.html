{% extends "base.html" %} {% block content %}

<section class="container" id="page-callout">
  <img
    id="page-img"
    src="{{ url_for('static', filename='assets/images/recipes-img.jpg') }}"
    alt="background"
  />
  <div id="page-overlay-text">
    <!--Page Title-->
    <h3>Recipes</h3>
    <!--Add recipes btn-->
    <a id="add-recipe-btn" class="btn" href="{{ url_for('add_recipe') }}"
      >Add recipe <i class="material-icons">add_circle_outline</i>
    </a>
    <!--Search bar-->
    <div id="search-bar" class="row card-panel grey lighten-5">
      <form action="{{ url_for('search') }}" method="POST" class="col s8">
        <div id="input-outer" class="row valign-wrapper center-align">
          <div class="input-field col s10">
            <input
              type="text"
              name="query"
              id="query"
              minlength="3"
              class="validate"
              required
            />
            <label for="query">Search Recipes</label>
          </div>
          <!--Search btn-->
          <div class="col s1">
            <a id="clear-btn" href="{{ url_for('get_recipes') }}">
              <i class="material-icons">cancel</i>
            </a>
          </div>
          <div class="col s1">
            <button id="search-btn" type="submit">
              <i class="material-icons">search</i>
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>

{% if recipes|length > 0 %}

<div id="card-container">
  <div class="row">
    {% for recipe in recipes %}
    <div class="col s6 m4 l3">
      <div href="" id="recipe-card" class="card">
        <div class="card-image" id="card-img">
          <a href="{{ url_for('view_recipe', recipe_id=recipe._id) }}">
            <img src="{{ recipe.img_url }}" alt="Recipe image" />
          </a>
        </div>
        <div id="card-info" class="row card-content">
          <div class="col s12">
            <p id="card-title"><strong>{{ recipe.recipe_name }}</strong></p>
            <p>by: {{ recipe.created_by }}</p>
            <p><i class="fas fa-globe"></i> {{ recipe.cuisine_name }}</p>
          </div>
          <div id="card-btns">
            <div id="card-edit-row" class="col s12">
              {% if session.user|lower == recipe.created_by|lower %}
              <a
                href="{{ url_for('edit_recipe', recipe_id=recipe._id) }}"
                id="card-edit"
                class="btn right"
                >Edit</a
              >
            </div>
            <div id="card-delete-row" class="col s12">
              <!-- Modal Trigger -->
              <a
                data-target="{{ recipe._id }}"
                id="card-del"
                class="btn right modal-trigger"
                >Delete</a
              >
              {% endif %}

              <!-- Modal Structure -->
              <div id="{{ recipe._id }}" class="modal">
                <div class="modal-content">
                  <h5>Are you sure you want to delete this recipe?</h5>
                </div>
                <br />
                <div class="modal-footer">
                  <a href="#!" id="modal-close" class="modal-close btn"
                    >cancel</a
                  >
                  <a
                    href="{{ url_for('delete_recipe', recipe_id=recipe._id) }}"
                    id="modal-confirm"
                    class="btn"
                    >Confirm</a
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% else %}
<h3 id="no-results">No results found</h3>
{% endif %} {% endblock %}
